1. name of the police officer,number of crimes AND station where the crime has closed from 2019 to 2022
2. crime name, time duration where time duration between registering crime and closing crime of the solved crimes is more than 2 years
3. number of crimes and crime that has been closed the most and least
4. Name of crime with total number that has been closed this year
5. year and month along with total number of crimes where crime has been closed the most and the least


1. 

SELECT OFFICER_NAME, STATION_NAME,NO_OF_CASES, YEAR, CRIME_STATUS FROM(
SELECT DISTINCT OFFICER_NAME, STATION_NAME, YEAR, CRIME_STATUS,CRIME_NAME, COUNT(CRIME_NAME) as NO_OF_CASES
FROM DIM_REGISTER R  
left JOIN DIM_OFFICER O
ON R.OFFICER_ID=O.OFFICER_ID  
left JOIN DIM_STATION S
ON R.OFFICER_ID=S.STATION_ID 
left JOIN DIM_TIME T
ON T.YEAR=TO_CHAR(CLOSE_DATE,'YYYY') 
GROUP BY OFFICER_NAME,STATION_NAME,YEAR,CRIME_STATUS,CRIME_NAME
) where crime_status='CLOSED' and YEAR BETWEEN 2019 AND 2022;

2.

SELECT DISTINCT CRIME_NAME,NO_OF_YEARS FROM 
(SELECT CRIME_NAME, NO_OF_YEARS FROM FACT_CRIME F JOIN DIM_REGISTER R ON F.REGISTER_NO=R.REGISTER_NO AND NO_OF_YEARS>5);

3.
SELECT CRIME_NAME,TOTAL_NO_OF_CRIMES, CRIME_STATUS FROM(
SELECT CRIME_NAME, COUNT(CRIME_NAME) AS TOTAL_NO_OF_CRIMES, CRIME_STATUS, RANK() OVER (ORDER BY COUNT(CRIME_NAME) DESC) AS RANK
FROM DIM_REGISTER WHERE crime_status='CLOSED'  group by crime_name, crime_status) WHERE RANK =1
UNION ALL 
SELECT CRIME_NAME,TOTAL_NO_OF_CRIMES, CRIME_STATUS FROM(
SELECT CRIME_NAME, COUNT(CRIME_NAME) AS TOTAL_NO_OF_CRIMES, CRIME_STATUS, RANK() OVER (ORDER BY COUNT(CRIME_NAME) ASC) AS LEAST_RANK
FROM DIM_REGISTER WHERE crime_status='CLOSED'  group by crime_name, crime_status) WHERE LEAST_RANK =1;

4.
SELECT CRIME_NAME, CRIME_STATUS,COUNT(CRIME_NAME)AS NO_OF_CASES, YEAR FROM FACT_CRIME F
JOIN DIM_TIME T
ON F.TIME_ID=T.TIME_ID
JOIN DIM_REGISTER R
ON F.REGISTER_NO=R.REGISTER_NO and CRIME_STATUS='CLOSED' AND YEAR=2023 
GROUP BY CRIME_NAME,CRIME_STATUS,YEAR;

5.
SELECT YEAR,MONTH, CRIME_STATUS,TOTAL_NO_OF_CRIMES FROM(
SELECT YEAR,MONTH,CRIME_NAME, COUNT(CRIME_NAME) AS TOTAL_NO_OF_CRIMES, CRIME_STATUS, RANK() OVER (ORDER BY COUNT(CRIME_NAME) DESC) AS RANK
FROM FACT_CRIME F 
JOIN DIM_REGISTER R
ON F.REGISTER_NO=R.REGISTER_NO
JOIN DIM_TIME T
ON F.TIME_ID=T.TIME_ID
group by crime_name, crime_status,year,month) WHERE RANK =1 and crime_status='CLOSED' 
UNION ALL 
SELECT YEAR,MONTH, CRIME_STATUS,TOTAL_NO_OF_CRIMES FROM(
SELECT YEAR,MONTH,CRIME_NAME, COUNT(CRIME_NAME) AS TOTAL_NO_OF_CRIMES, CRIME_STATUS, RANK() OVER (ORDER BY COUNT(CRIME_NAME) ASC) AS RANK
FROM FACT_CRIME F 
JOIN DIM_REGISTER R
ON F.REGISTER_NO=R.REGISTER_NO
JOIN DIM_TIME T
ON F.TIME_ID=T.TIME_ID
group by crime_name, crime_status,year,month) WHERE RANK =1 and crime_status='CLOSED';

---------------------------------------------------------------------------------

SELECT crime_name, CRIME_STATUS,RANK() OVER (ORDER BY count(crime_name) desc) AS rank from dim_register where crime_status='CLOSED'  group by crime_name, crime_status;







